(()=>{"use strict";function t(n){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(n)}function n(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function e(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(n){o(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}function o(n,e,o){return(e=function(n){var e=function(n){if("object"!=t(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var o=e.call(n,"string");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==t(e)?e:e+""}(e))in n?Object.defineProperty(n,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[e]=o,n}function r(t){if(console.log(r),t&&t.id&&t.title&&t.price){var n=JSON.parse(localStorage.getItem("cart"))||[],o=n.find((function(n){return n.id===t.id}));o?o.quantity+=1:n.push(e(e({},t),{},{quantity:1})),localStorage.setItem("cart",JSON.stringify(n)),function(){var t=JSON.parse(localStorage.getItem("cart"))||[],n=document.getElementById("cart-container");n.innerHTML="",0!==t.length?t.forEach((function(t){var e=document.createElement("div");e.textContent="".concat(t.title," — ").concat(t.quantity," шт. — ").concat(t.price*t.quantity," ₽"),n.appendChild(e)})):n.textContent="Корзина пуста"}()}else console.error("Некорректный объект книги")}var i,a=0,c="Business",l=document.querySelector(".articles"),s=document.querySelector(".btn__load"),u=null!==(i=JSON.parse(localStorage.getItem("cart")))&&void 0!==i?i:[];function d(t){var n='https://www.googleapis.com/books/v1/volumes?q="subject:'.concat(c,'"&key=').concat("AIzaSyCTdVNdNjdYLWLRMEZaueMFT24UCra-18I","&printType=books&startIndex=").concat(a,"&maxResults=").concat(6,"&langRestrict=en");return fetch(n).then((function(t){return t.json()})).then((function(t){console.log(t),t.items&&t.items.length>0&&(t.items.forEach((function(t){var n=function(t){var n,e;return console.log(u),console.log(u.find((function(n){return n.id===t.id}))),'\n    <div class="article-book">\n      <div class="book__pic">\n      <img class="book__portrait" src="'.concat(null!==(n=null===(e=t.volumeInfo.imageLinks)||void 0===e?void 0:e.thumbnail)&&void 0!==n?n:"./images/no-photo.png",'" alt="Book Portrait"/>\n    </div>\n      <div class="book__info-container">\n        <div class="book__info">\n          <p class="book__author">').concat(t.volumeInfo.authors||"Unknown Author",'</p>\n          <h3 class="book__title">').concat(t.volumeInfo.title||"No Title",'</h3>\n\n          <div class="rating">\n            <div class="rating__body">\n              <div class="rating__active"></div>\n              <div class="rating__items">\n                <input type="radio" class="rating__item" value="1" name="rating">\n                <input type="radio" class="rating__item" value="2" name="rating">\n                <input type="radio" class="rating__item" value="3" name="rating">\n                <input type="radio" class="rating__item" value="4" name="rating">\n                <input type="radio" class="rating__item" value="5" name="rating">\n              </div>\n              <div class="rating__value"></div>\n            </div>\n          </div>\n\n          <p class="book__description">').concat(t.volumeInfo.description||"No description available",'</p>\n          <p class="book__price"> ').concat(t.volumeInfo.pageCount||"Price not available",'$</p>\n          <button class="add-to-bag ').concat(u.find((function(n){return n.id===t.id}))?"add-to-bag-active":"",'" data-id="').concat(t.id,'">\n          ').concat(u.find((function(n){return n.id===t.id}))?"in the cart":"buy now","\n          </button>\n        </div>\n      </div>\n    </div>\n    ")}(t);l.innerHTML+=n})),function(){for(var t,n,e=document.querySelectorAll(".rating"),o=0;o<e.length;o++)r=e[o],t=r.querySelector(".rating__active"),n=r.querySelector(".rating__value"),function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.innerHTML)/5*100;t.style.width="".concat(e,"%")}(),function(){var e=(4*Math.random()+1).toFixed(1);if(n&&(n.textContent=e,t)){var o=e/5*100;t.style.width="".concat(o,"%")}}();var r}())})).catch((function(t){console.error("Error from API:",t)}))}document.addEventListener("click",(function(t){t.target.classList.contains("genre-item")&&(document.querySelector(".genre-active").classList.remove("genre-active"),t.target.classList.add("genre-active"),c=t.target.innerText,l.innerHTML="",a=0,d())})),s.addEventListener("click",(function(){a+=6,d()})),document.addEventListener("DOMContentLoaded",(function(){d(),function(){var t=document.querySelector(".products-count");if(t){var n=0;document.addEventListener("click",(function(e){if(e.target.classList.contains("add-to-bag")){console.log("Кнопка найдена:",e.target),console.log(document.querySelector(".products-count")),console.log(document.querySelector(".add-to-bag"));var o=e.target.getAttribute("data-id");e.target.classList.toggle("add-to-bag-active"),e.target.classList.contains("add-to-bag-active")?(e.target.textContent="in the cart",n++,r({id:o,title:"123",price:123})):(e.target.textContent="buy now",n--),n>0?(t.style.display="block",t.textContent=n):t.style.display="none"}}))}else console.error("Элемент .products-count не найден!")}()}))})();